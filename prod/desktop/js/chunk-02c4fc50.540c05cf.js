(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02c4fc50"],{3634:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{fluid:""}},[a("v-card",[a("v-toolbar",{attrs:{flat:"",dense:"",color:"info",dark:""}},[a("v-toolbar-title",{staticClass:"ma-auto"},[a("span",{staticClass:"text-centre text-overline"},[e._v(" Share Timetable with your peeps "),a("v-icon",[e._v("mdi-account-group-outline")])],1)])],1),a("v-tabs",{attrs:{vertical:""},model:{value:e.selectedTab,callback:function(t){e.selectedTab=t},expression:"selectedTab"}},[a("v-tab",[a("v-icon",{attrs:{left:""}},[e._v(" mdi-calendar-import ")]),e._v(" import ")],1),a("v-tab",[a("v-icon",{attrs:{left:""}},[e._v(" mdi-calendar-export ")]),e._v(" export ")],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-container",{staticClass:"mt-2 import-container"},[a("v-row",{attrs:{justify:"center"}},[a("v-col",{staticClass:"pb-0 mb-0",attrs:{cols:"8"}},[a("v-text-field",{ref:"importForm",attrs:{label:"Paste the Share ID ...",type:"text","clear-icon":"mdi-close","append-outer-icon":"mdi-send",solo:"",dense:"",clearable:"",rules:[function(){return!!e.importTimetable.typedShareID||"This field is required"},function(){return e.importTimetable.typedShareID&&32===e.importTimetable.typedShareID.length||"Share ID must be 32 characters long"}],counter:"32",required:""},on:{focus:function(t){e.importTimetable.inputfocused=!0},blur:function(t){e.importTimetable.inputfocused=!1},"click:append-outer":e.fetchTimetable},scopedSlots:e._u([{key:"prepend-inner",fn:function(){return[a("div",{staticClass:"mr-3"},[a("v-icon",{attrs:{color:e.importTimetable.inputfocused?"primary":""}},[e._v("mdi-share-variant")])],1)]},proxy:!0}]),model:{value:e.importTimetable.typedShareID,callback:function(t){e.$set(e.importTimetable,"typedShareID",t)},expression:"importTimetable.typedShareID"}})],1),a("v-col",{staticClass:"pb-0 mb-0 text-center",attrs:{cols:"3"}},[!e.importTimetable.timetableLoading&&e.importTimetable.timetableExists?a("v-btn",{attrs:{outlined:"",tile:"",color:"primary",depressed:""},on:{click:e.takeScreenshot}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-camera")]),e._v(" save timetable ")],1):e._e()],1)],1),a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:"12"}},[e.importTimetable.timetableLoading?a("v-sheet",[a("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"table"}})],1):!e.importTimetable.timetableLoading&&e.importTimetable.timetableExists?a("v-row",{staticClass:"fill-height"},[a("v-col",[a("v-sheet",{attrs:{id:"my-imported-timetable-box"}},[a("v-calendar",{ref:"calendar",staticClass:"my-view-calender",attrs:{color:"primary",events:e.importTimetable.events,"event-color":e.getEventColor,type:"week","first-interval":8,"interval-minutes":60,"interval-count":12,"weekday-format":e.formatDayString},on:{"click:event":e.showEvent,change:e.updateRange},scopedSlots:e._u([{key:"event",fn:function(t){var r=t.event,i=t.timeSummary;return[a("div",{staticClass:"pl-1 m-0 black--text"},[a("strong",[e._v(e._s(r.name))]),a("br"),e._v(" "+e._s(i())+" ")])]}}]),model:{value:e.importTimetable.focus,callback:function(t){e.$set(e.importTimetable,"focus",t)},expression:"importTimetable.focus"}}),a("v-menu",{attrs:{"close-on-content-click":!1,activator:e.importTimetable.selectedElement,"offset-x":""},model:{value:e.importTimetable.selectedOpen,callback:function(t){e.$set(e.importTimetable,"selectedOpen",t)},expression:"importTimetable.selectedOpen"}},[a("v-card",{attrs:{color:"grey lighten-4","min-width":"350px",dense:"",flat:""}},[a("v-toolbar",{attrs:{color:e.importTimetable.selectedEvent.color,height:"50px"}},[a("v-toolbar-title",{staticClass:"pl-1"},[a("span",{staticClass:"black--text"},[e._v(e._s(e.importTimetable.selectedEvent.title))])])],1),a("v-card-text",[a("span",{domProps:{innerHTML:e._s(e.importTimetable.selectedEvent.details)}})])],1)],1)],1)],1)],1):e._e()],1)],1)],1)],1)],1),a("v-tab-item",[a("v-card",{attrs:{flat:""}},[a("v-container",{staticClass:"mt-2 import-container"},[a("v-row",{attrs:{justify:"center"}},[a("v-col",{staticClass:"pb-0 mb-0",attrs:{cols:"8"}},[a("v-text-field",{ref:"myTimetableExportedID",attrs:{label:"Exported Share ID",dense:"",type:"text",solo:"",readonly:"","append-outer-icon":"mdi-content-copy"},on:{"click:append-outer":e.copyExportedLink},scopedSlots:e._u([{key:"prepend-inner",fn:function(){return[a("div",{staticClass:"mr-3"},[a("v-icon",[e._v(" mdi-share-variant ")])],1)]},proxy:!0}]),model:{value:e.exportTimetable.shareID,callback:function(t){e.$set(e.exportTimetable,"shareID",t)},expression:"exportTimetable.shareID"}})],1),a("v-col",{staticClass:"pb-0 mb-0 text-center",attrs:{cols:"3"}},[e.exportTimetable.timetableLoading||!e.exportTimetable.timetableExists||e.myTimetableExported?e._e():a("v-btn",{attrs:{outlined:"",tile:"",color:"primary",depressed:""},on:{click:e.exportMyTimetable}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-share-outline")]),e._v(" export timetable ")],1)],1)],1),a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:"12"}},[e.exportTimetable.timetableLoading?a("v-sheet",[a("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"table"}})],1):!e.exportTimetable.timetableLoading&&e.exportTimetable.timetableExists?a("v-row",{staticClass:"fill-height"},[a("v-col",[a("v-sheet",{attrs:{id:"my-imported-timetable-box"}},[a("v-calendar",{ref:"calendar",staticClass:"my-view-calender",attrs:{color:"primary",events:e.exportTimetable.events,"event-color":e.getEventColor,type:"week","first-interval":8,"interval-minutes":60,"interval-count":12,"weekday-format":e.formatDayString},on:{"click:event":e.showEvent,change:e.updateRange},scopedSlots:e._u([{key:"event",fn:function(t){var r=t.event,i=t.timeSummary;return[a("div",{staticClass:"pl-1 m-0 black--text"},[a("strong",[e._v(e._s(r.name))]),a("br"),e._v(" "+e._s(i())+" ")])]}}]),model:{value:e.exportTimetable.focus,callback:function(t){e.$set(e.exportTimetable,"focus",t)},expression:"exportTimetable.focus"}}),a("v-menu",{attrs:{"close-on-content-click":!1,activator:e.exportTimetable.selectedElement,"offset-x":""},model:{value:e.exportTimetable.selectedOpen,callback:function(t){e.$set(e.exportTimetable,"selectedOpen",t)},expression:"exportTimetable.selectedOpen"}},[a("v-card",{attrs:{color:"grey lighten-4","min-width":"350px",dense:"",flat:""}},[a("v-toolbar",{attrs:{color:e.exportTimetable.selectedEvent.color,height:"50px"}},[a("v-btn",{attrs:{icon:""},on:{click:function(t){return e.editSchedule(e.exportTimetable.selectedEvent.courseID)}}},[a("v-icon",{attrs:{color:"black"}},[e._v("mdi-pencil")])],1),a("v-toolbar-title",{staticClass:"pl-1"},[a("span",{staticClass:"black--text"},[e._v(e._s(e.exportTimetable.selectedEvent.title))])])],1),a("v-card-text",[a("span",{domProps:{innerHTML:e._s(e.exportTimetable.selectedEvent.details)}})])],1)],1)],1)],1)],1):e._e()],1)],1)],1)],1)],1)],1)],1)],1),a("my-show-screenshot",{ref:"myScreenshotViewer",on:{confirmQuery:e.saveScreenshot}}),a("v-overlay",{attrs:{value:e.exportingMyTimetable}},[a("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1)],1)},i=[],s=a("3835"),o=a("2909"),n=a("5530"),l=a("1da1"),c=(a("498a"),a("ac1f"),a("5319"),a("d81d"),a("c740"),a("1276"),a("99af"),a("d3b7"),a("159b"),a("96cf"),a("2ef0")),m=a.n(c),u=a("c1df"),p=a.n(u),d=a("c0e9"),b=a.n(d),v=a("42fc"),h={name:"share-timetable",components:{"my-show-screenshot":v["a"]},data:function(){return{selectedTab:0,exportingMyTimetable:!1,myTimetableExported:!1,weekdaysStrings:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],colorsMapper:{labs:"purple accent-1",lectures:"green accent-2",tutorials:"orange accent-1"},typesMapper:{labs:"Practical",lectures:"Lecture",tutorials:"Tutorial"},daysMapper:{0:"Su",1:"M",2:"T",3:"W",4:"Th",5:"F",6:"S"},importTimetable:{currentRenderedID:null,typedShareID:"",inputfocused:!1,timetableLoading:!1,timetableExists:!1,showHint:!1,focus:"",selectedEvent:{},selectedElement:null,selectedOpen:!1,events:[],scheduledCourses:[]},exportTimetable:{shareID:"",inputfocused:!1,timetableLoading:!1,timetableExists:!1,showHint:!1,focus:"",selectedEvent:{},selectedElement:null,selectedOpen:!1,events:[],scheduledCourses:[]}}},watch:{selectedTab:function(e){1===e&&this.fecthMyTimetable()}},mounted:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!m.a.has(e.$route.query,"share_id")){t.next=8;break}return a=m.a.get(e.$route.query,"share_id"),t.next=4,e.$store.dispatch("sendRequest",{method:"GET",url:"timetable/import/".concat(a)});case 4:r=t.sent,i=r.scheduledCourses,s=r.error,Array.isArray(i)?(e.importTimetable.scheduledCourses=e.parseCourses(i),e.importTimetable.timetableExists=!0,e.importTimetable.currentRenderedID=a,e.importTimetable.typedShareID=a):e.$store.commit("ADD_NOTIFICATION",{message:m.a.upperCase(s),type:"error"});case 8:case"end":return t.stop()}}),t)})))()},methods:{editSchedule:function(e){this.$router.push({name:"EditTimetable",query:Object(n["a"])(Object(n["a"])({},this.$route.query),{},{course_id:e})})},fetchTimetable:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,a=e.importTimetable.typedShareID,a&&32===a.trim().length&&e.importTimetable.currentRenderedID!==a){t.next=5;break}return e.$refs.importForm.validate(!0),t.abrupt("return");case 5:return e.importTimetable.timetableLoading=!0,e.importTimetable.timetableExists=!1,t.next=9,e.$store.dispatch("sendRequest",{method:"GET",url:"timetable/import/".concat(a)});case 9:r=t.sent,i=r.scheduledCourses,s=r.error,Array.isArray(i)?(a!==e.$route.query.share_id&&e.$router.replace({name:"ShareTimetable",query:Object(n["a"])(Object(n["a"])({},e.$route.query),{},{share_id:a})}),e.importTimetable.scheduledCourses=e.parseCourses(i),e.importTimetable.timetableExists=!0,e.importTimetable.currentRenderedID=a):e.$store.commit("ADD_NOTIFICATION",{message:m.a.upperCase(s),type:"error"}),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),console.log(t.t0);case 18:e.importTimetable.timetableLoading=!1;case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))()},fecthMyTimetable:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("getMyScheduledCourses");case 3:a=t.sent,e.exportTimetable.timetableLoading=!0,e.exportTimetable.timetableExists=!1,Array.isArray(a)&&(e.exportTimetable.scheduledCourses=a,e.exportTimetable.timetableExists=!0),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:e.exportTimetable.timetableLoading=!1;case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},parseCourses:function(e){return e.map((function(e){return Object(n["a"])(Object(n["a"])(Object(n["a"])({},e),e.courseDetail),{},{_id:e.courseDetail._id,courseDetail:void 0,course:void 0})}))},viewDay:function(e){var t=e.date;this.focus=t,this.type="day"},formatDayString:function(e){return this.weekdaysStrings[e.weekday]},getEventColor:function(e){return e.color},setToday:function(){this.importTimetable.focus=""},prev:function(){this.$refs.calendar.prev()},next:function(){this.$refs.calendar.next()},updateRange:function(e){var t=e.start,a=e.end;this.startTimestamp=t,this.endTimestamp=a;var r=this.getDaysArray(t.date,a.date);this.setCalenderSlots(r)},getDaysArray:function(e,t){for(var a=[],r=new Date(e);r<=new Date(t);r.setDate(r.getDate()+1))a.push(new Date(r));return a},setCalenderSlots:function(e){for(var t=[],a=0===this.selectedTab?this.importTimetable.scheduledCourses:this.exportTimetable.scheduledCourses,r=0;r<e.length;r++)for(var i=e[r],s=0;s<a.length;s++){var n=a[s],l=m.a.has(n,"lecturesSection")&&m.a.get(n,"lecturesSection"),c=m.a.has(n,"tutorialsSection")&&m.a.get(n,"tutorialsSection"),u=m.a.has(n,"labsSection")&&m.a.get(n,"labsSection");l&&t.push.apply(t,Object(o["a"])(this.setSlots(n,i,"lectures"))),c&&t.push.apply(t,Object(o["a"])(this.setSlots(n,i,"tutorials"))),u&&t.push.apply(t,Object(o["a"])(this.setSlots(n,i,"labs")))}0===this.selectedTab?this.importTimetable.events=t:this.exportTimetable.events=t},setSlots:function(e,t,a){var r=[],i=e["".concat(a,"Section")],o=i.timings,n=this.daysMapper[t.getDay()],l=o.findIndex((function(e){return e.dayCode===n}));if(l>=0){var c=o[l].time,m=c.split(" - "),u=Object(s["a"])(m,2),d=u[0],b=u[1],v="".concat(t.toISOString().substr(0,10)," ").concat(d),h="".concat(t.toISOString().substr(0,10)," ").concat(b),f="";i.instructors.forEach((function(e){return f+="<li>".concat(e,"</li>")}));var T={start:v,end:h,color:this.colorsMapper[a],name:"".concat(e.courseCode," - ").concat(i.section),title:"".concat(e.courseName),courseID:e._id,details:"\n\t\t\t\t\t\t<div class='black--text'>\n\t\t\t\t\t\t\t<h4>".concat(this.typesMapper[a]," Section - ").concat(i.section,"</h4>\n\t\t\t\t\t\t\t<h4>Instructor(s)</h4>\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t").concat(f,"\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t<h4>Comprehensive Exam: ").concat(p()(e.comprehensiveExamDate).format("Do MMM,  h:mm A"),"</h4>\n\t\t\t\t\t\t\t<h4>Course IC: ").concat(e.IC,"</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t")};r.push(T)}return r},showEvent:function(e){var t=this,a=e.nativeEvent,r=e.event;if(0===this.selectedTab){var i=function(){t.importTimetable.selectedEvent=r,t.importTimetable.selectedElement=a.target,setTimeout((function(){t.importTimetable.selectedOpen=!0}),10)};this.importTimetable.selectedOpen?(this.importTimetable.selectedOpen=!1,setTimeout(i,10)):i()}else{var s=function(){t.exportTimetable.selectedEvent=r,t.exportTimetable.selectedElement=a.target,setTimeout((function(){t.exportTimetable.selectedOpen=!0}),10)};this.exportTimetable.selectedOpen?(this.exportTimetable.selectedOpen=!1,setTimeout(s,10)):s()}a.stopPropagation()},takeScreenshot:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b()(document.getElementById("my-imported-timetable-box"));case 2:a=t.sent,e.$refs.myScreenshotViewer.showDialog(a.toDataURL("image/png"));case 4:case"end":return t.stop()}}),t)})))()},saveScreenshot:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=e.choosenOption,i=e.imageData,r&&t.downloadURI(i,"timtable-schedule.png"),t.$refs.myScreenshotViewer.hideDialog();case 3:case"end":return a.stop()}}),a)})))()},downloadURI:function(e,t){var a=document.createElement("a");a.download=t,a.href=e,a.click()},exportMyTimetable:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.exportingMyTimetable=!0,t.next=4,e.$store.dispatch("sendRequest",{method:"POST",url:"timetable/export",requestBody:e.exportTimetable.scheduledCourses});case 4:a=t.sent,r=a.shareID,e.exportTimetable.shareID=r,e.exportingMyTimetable=!1,e.myTimetableExported=!0,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},copyExportedLink:function(){if(this.exportTimetable.shareID&&32===this.exportTimetable.shareID.length){if(navigator.clipboard){var e=window.location.origin+"/share-timetable?share_id="+this.exportTimetable.shareID;navigator.clipboard.writeText(e)}else{var t=this.$refs.myTimetableExportedID.$el.querySelector("input");t.select(),document.execCommand("copy")}this.$store.commit("ADD_NOTIFICATION",{message:m.a.upperCase("copied to clipboard"),type:"success"})}}}},f=h,T=(a("d786"),a("2877")),x=a("6544"),y=a.n(x),g=a("8336"),w=a("a4f6"),S=a("b0af"),C=a("99d9"),k=a("62ad"),D=a("a523"),E=a("132d"),I=a("e449"),_=a("a797"),O=a("490a"),$=a("0fd9"),R=a("8dd9"),M=a("3129"),j=a("71a3"),V=a("c671"),L=a("fe57"),A=a("8654"),q=a("71d9"),F=a("2a7f"),N=Object(T["a"])(f,r,i,!1,null,"3f65dea8",null);t["default"]=N.exports;y()(N,{VBtn:g["a"],VCalendar:w["a"],VCard:S["a"],VCardText:C["b"],VCol:k["a"],VContainer:D["a"],VIcon:E["a"],VMenu:I["a"],VOverlay:_["a"],VProgressCircular:O["a"],VRow:$["a"],VSheet:R["a"],VSkeletonLoader:M["a"],VTab:j["a"],VTabItem:V["a"],VTabs:L["a"],VTextField:A["a"],VToolbar:q["a"],VToolbarTitle:F["a"]})},d786:function(e,t,a){"use strict";a("e01b")},e01b:function(e,t,a){}}]);
//# sourceMappingURL=chunk-02c4fc50.540c05cf.js.map